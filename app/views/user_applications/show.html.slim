.r
  a href=url_for(:window_size=>'1_hour') 1-hour
  a href=url_for(:window_size=>'1_day') 1-day
  a href=url_for(:window_size=>'7_day') 7-day
  a href=url_for(:window_size=>'1_month') 1-mo
hr
= @slices.map(&:timestamp).to_json

div style='position: relative; height: 300px'

  div id="req_times"   style='position: absolute; top: 0;'
  div id="req_counts"  style='position: absolute; top: 0;'
  div id='deployments' style='position: relative; top: 220px;'


- if @slices.length > 0
  javascript:
    var app_load               = #{get_app_load(@slices).to_json.html_safe};
    var app_uptime             = #{get_app_uptime(@slices).to_json.html_safe};
    var slice_data             = #{@slices.to_json.html_safe};
    var exceptions             = #{extract_exception_data_for_app_show(@slices).to_json.html_safe};
    var deployments            = #{extract_deployment_data_for_app_show(@deployments).to_json.html_safe};
    var request_data_groups    = #{extract_request_data_for_app_show(@slices, @deployments).to_json.html_safe};

    var min_ts = 0;
    var max_ts = 100;

    var palette = new Rickshaw.Color.Palette( { sheme: 'colorwheel' });



    var stacked_response_times_data = #{extract_stacked_response_times_for_app_show(@slices).to_json.html_safe};
    var request_times_series = [];

    for (var i = 0 ; i < stacked_response_times_data.length; i++) {
      request_times_series.push({
          color: palette.color(),
          data: stacked_response_times_data[i]
        });
    }

    var request_times_graph = new Rickshaw.Graph( {
        element: document.querySelector("#req_times"),
        width: 940,
        height: 200,
        renderer: 'bar',
        series: request_times_series
    });


    var request_counts_graph = new Rickshaw.Graph( {
        element: document.querySelector("#req_counts"),
        width: 940,
        renderer: 'line',
        height: 200,
        series: [{
          color: palette.color(),
          data: #{extract_request_counts_for_app_show(@slices).to_json.html_safe}
        }]
    });

    var deployments_graph = new Rickshaw.Graph.Annotate({
        graph: request_counts_graph,
        element: document.getElementById('deployments')
    });

    for (var i=0; i < deployments.length; i++) {
      deployments_graph.add(deployments[i][0], deployments[i][1]);
    }

    request_counts_graph.render();
    request_times_graph.render();
